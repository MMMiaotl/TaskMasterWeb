{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>我的消息</h2>
    
    <!-- 收到的消息 -->
    <div class="received-messages mt-4">
        <h3>收到的消息</h3>
        {% if received_messages %}
            {% for message in received_messages %}
            <div class="message-item card mb-3">
                <div class="card-body">
                    <div class="message-meta text-muted mb-2">
                        <small>
                            来自: {{ message.sender.username }} | 
                            时间: {{ message.created_at.strftime('%Y-%m-%d %H:%M') }}
                            {% if message.task %}
                                | 关于任务: <a href="{{ url_for('task.task_detail', task_id=message.task.id) }}">{{ message.task.title }}</a>
                            {% endif %}
                        </small>
                    </div>
                    <p class="card-text">{{ message.content }}</p>
                    <a href="{{ url_for('message.send_message', recipient_id=message.sender.id) }}" 
                       class="btn btn-sm btn-outline-primary">回复</a>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p>暂无收到的消息</p>
        {% endif %}
    </div>

    <!-- 发送的消息 -->
    <div class="sent-messages mt-4">
        <h3>发送的消息</h3>
        {% if sent_messages %}
            {% for message in sent_messages %}
            <div class="message-item card mb-3">
                <div class="card-body">
                    <div class="message-meta text-muted mb-2">
                        <small>
                            发给: {{ message.recipient.username }} | 
                            时间: {{ message.created_at.strftime('%Y-%m-%d %H:%M') }}
                            {% if message.task %}
                                | 关于任务: <a href="{{ url_for('task.task_detail', task_id=message.task.id) }}">{{ message.task.title }}</a>
                            {% endif %}
                        </small>
                    </div>
                    <p class="card-text">{{ message.content }}</p>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p>暂无发送的消息</p>
        {% endif %}
    </div>
</div>
{% endblock %}
